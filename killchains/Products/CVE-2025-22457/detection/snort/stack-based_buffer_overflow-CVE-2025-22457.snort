stream = { }
stream_ip = { }
stream_tcp = { }

http_inspect = { }

wizard = {
    spells = {
        { service = 'http', proto = 'tcp', to_server = {'GET', 'POST'}, to_client = {'HTTP/'} }
    }
}

binder = {
    { when = { service = 'http' }, use = { type = 'http_inspect' } },
    { use = { type = 'wizard' } }
}

ips = {
    include = 'stack-based_buffer_overflow-CVE-2025-22457-detect.snort',
    variables = {
        nets = {
            ANY_ADDRESS = 'any',
            IVANTI_ADDR = '198.18.200.84',
            INTERNAL_NET = '198.18.200.0/24',
            EXTERNAL_NET = 'any'
        }
    }
}

default_classifications =
{
    { name = 'Ivanti_Policy_Secure--CVE-2025-22457', priority = 1,
      text = 'Stack-based buffer overflow attempt against Ivanti Policy Secure ZTA Gateway (CVE-2025-22457)' },
    { name = 'HTTP_header_overflow', priority = 2,
      text = 'Malicious HTTP X-Forwarded-For header buffer overflow attempt' },
    { name = 'Heap_spray_attack', priority = 2,
      text = 'Heap spray attack pattern detected in HTTP headers' },
}
