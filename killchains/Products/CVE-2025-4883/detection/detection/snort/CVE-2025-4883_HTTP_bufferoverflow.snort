network = {
    checksum_eval = 'none', 
}

stream = {}
stream_ip = {}

stream_tcp = {
    policy = "linux"
}

stream_tcp_reassembly = {
    enable = true,
    memcap = 500000000,
    depth = 0,
    max_pdu = 16384
}

http_inspect = {
    request_depth = 0,
    response_depth = 0
}

wizard = {
    spells = {
        { service = 'http', proto = 'tcp', to_server = { 'GET' }, to_client = { 'HTTP/' } }
    }
}

binder = {
   { when = { service = 'http' }, use = { type = 'http_inspect' } },
}

ips = { include = 'detection/snort/CVE-2025-4883_HTTP_bufferoverflow-detect.snort', variables = { nets = { ANY_ADDRESS = 'any', DLINK_ADDR = '198.18.200.51' } } }

default_classifications =
{
    { name = 'D-Link_DI-8100--activity', priority = 1,
      text = 'Buffer overflow attempt to the D-Link_DI-8100 router' },
}