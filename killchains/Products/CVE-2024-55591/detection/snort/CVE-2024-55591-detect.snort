alert tcp $ANY_ADDRESS any -> $FORTIOS_ADDR any (
    msg:"Possible FortiGate WebSocket CLI Pre-auth Access";
    reference:cve,2024-55591;
    reference:url,https://github.com/TroutSoftware/eu-tis/issues/7;
    content:"GET /ws/cli/open";
    content:"Upgrade: websocket";
    classtype: FortiOS-activity;
    sid:5559101;
    rev:1;
)

alert tcp $ANY_ADDRESS any -> $FORTIOS_ADDR any ( 
    msg:"Possible FortiGate Auth Bypass via local_access_token";
    reference:cve,2024-55591;
    reference:url,https://github.com/TroutSoftware/eu-tis/issues/7;
    content:"local_access_token=";
    classtype: FortiOS-activity;
    sid:5559102;
    rev:1;
)

alert tcp $ANY_ADDRESS any -> $FORTIOS_ADDR any (
    msg:"Possible WebSocket Auth Bypass Detected";
    reference:cve,2024-55591;
    reference:url,https://github.com/TroutSoftware/eu-tis/issues/7;
    content:"GET /ws/cli/open?cols=";
    content:"local_access_token=";
    classtype: FortiOS-activity;
    sid:5559103;
    rev:1;
)

# try to match a possible 
alert tcp $ANY_ADDRESS any -> $FORTIOS_ADDR any (
    msg:"Possible FortiGate Privilege Escalation via WebSocket Payload";
    reference:cve,2024-55591;
    reference:url,https://github.com/TroutSoftware/eu-tis/issues/7;
    pcre:"/watchTowr|root|admin|super_admin/i";
    classtype: FortiOS-activity;
    sid:5559104;
    rev:1;
)


